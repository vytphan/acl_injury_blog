<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vy Phan">
<meta name="dcterms.date" content="2025-01-14">
<meta name="description" content="How risk classification models can inform training, recovery, and playing time decisions">

<title>ACL Injury Risk in Female Athletes: A Data Science Approach – Vy Phan</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-c1fac2584b48ed01fb6e278e36375074.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Vy Phan</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About Me</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/vytphan"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/vythuyphan/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">ACL Injury Risk in Female Athletes: A Data Science Approach</h1>
                  <div>
        <div class="description">
          How risk classification models can inform training, recovery, and playing time decisions
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Vy Phan </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 14, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="the-problem-acl-injuries-in-womens-sports" class="level1">
<h1>The Problem: ACL Injuries in Women’s Sports</h1>
<p>Anterior cruciate ligament (ACL) injuries occur at two to eight times higher rates in female athletes compared to male athletes, especially in cutting sports like soccer, basketball, and ultimate frisbee <span class="citation" data-cites="tjong2024gender allen2025npr">(<a href="#ref-tjong2024gender" role="doc-biblioref">Tjong 2024</a>; <a href="#ref-allen2025npr" role="doc-biblioref">Allen 2025</a>)</span>. Research shows that 55-70% of ACL injuries happen without contact—during sudden stops, pivots, or single-leg landings after jumps <span class="citation" data-cites="chia2022noncontact koga2010acl">(<a href="#ref-chia2022noncontact" role="doc-biblioref">Chia et al. 2022</a>; <a href="#ref-koga2010acl" role="doc-biblioref">Koga et al. 2010</a>)</span>. Beyond immediate pain and surgery, ACL injuries often disrupt athletic careers. Athletes who return to sport after ACL reconstruction face elevated reinjury risk, with studies reporting second ACL injury rates ranging from 6% to 30% depending on age and activity level <span class="citation" data-cites="wright2007second paterno2012incidence">(<a href="#ref-wright2007second" role="doc-biblioref">Wright et al. 2007</a>; <a href="#ref-paterno2012incidence" role="doc-biblioref">Paterno et al. 2012</a>)</span>.</p>
<p>The challenge is: how can we reduce ACL injury rates in female athletes?</p>
<p><img src="ulti.png" class="img-fluid" alt="Ultimate frisbee cutting movement"> Photo by UBC Women’s Ultimate (<a href="https://www.instagram.com/ubcwultimate/"><span class="citation" data-cites="ubcwultimate">(<span><strong>ubcwultimate?</strong></span>)</span></a>). Used with permission.</p>
</section>
<section id="step-1-gathering-data-on-injury-patterns" class="level1">
<h1>Step 1: Gathering Data on Injury Patterns</h1>
<p>The first step in addressing any data science problem is collecting relevant data. For ACL injury risk, this includes:</p>
<ul>
<li>Historical injury records: When and how injuries occurred</li>
<li>Physical performance metrics: Strength, balance, movement quality, and asymmetries between limbs</li>
<li>Training and competition data: Volume and intensity of recent activity</li>
</ul>
<p>By analyzing these datasets, researchers can identify patterns. Common risk factors include movement asymmetries, accumulated fatigue, and deficits in strength or balance. This data helps clarify when and under what conditions injuries are more likely to occur.</p>
</section>
<section id="step-2-the-gap-in-existing-research" class="level1">
<h1>Step 2: The Gap in Existing Research</h1>
<p>There is a gap in existing research: most injury prediction models are built primarily on data from male athletes, limiting their effectiveness for female athletes.</p>
<p>Research shows that ACL injury patterns in female athletes differ from those in male populations. Differences in neuromuscular control (how the brain and muscles coordinate movement), how forces are absorbed through joints, and recovery patterns have been documented, highlighting that injury models relying on male-dominated datasets may not work well for female athletes <span class="citation" data-cites="vandijk2020injury">(<a href="#ref-vandijk2020injury" role="doc-biblioref">Dijk et al. 2020</a>)</span>.</p>
<p>Additionally, many current models focus only on general physical metrics like training load or strength. While important, these approaches treat injury risk as static and overlook how risk changes over time due to physiological and contextual variations.</p>
<p>The problem: We need injury risk models specifically designed for female athletes that account for their unique physiology.</p>
</section>
<section id="step-3-building-a-female-specific-model" class="level1">
<h1>Step 3: Building a Female-Specific Model</h1>
<p>To address this gap, we can develop a risk estimation model that incorporates three types of data:</p>
<section id="movement-and-physical-readiness" class="level2">
<h2 class="anchored" data-anchor-id="movement-and-physical-readiness">1. Movement and Physical Readiness</h2>
<p>These variables describe how effectively an athlete generates and controls force during high-risk movements:</p>
<ul>
<li>Strength and balance assessments</li>
<li>Movement quality during cutting and landing</li>
<li>Asymmetries between left and right limbs</li>
</ul>
<p>These metrics represent baseline physical capacity and tend to change gradually over time.</p>
</section>
<section id="injury-history-and-training-load" class="level2">
<h2 class="anchored" data-anchor-id="injury-history-and-training-load">2. Injury History and Training Load</h2>
<ul>
<li>Prior injuries to the knee or leg</li>
<li>Playing experience</li>
<li>Recent training and competition volume</li>
</ul>
<p>Prior injury is a well-established risk factor for future ACL injury. Training load data helps characterize cumulative physical stress and recovery patterns.</p>
</section>
<section id="female-specific-contextual-factors" class="level2">
<h2 class="anchored" data-anchor-id="female-specific-contextual-factors">3. Female-Specific Contextual Factors</h2>
<p>This is what makes the model distinct. Research has demonstrated an association between hormonal fluctuations and ACL injury risk in female athletes <span class="citation" data-cites="hewett2007acl">(<a href="#ref-hewett2007acl" role="doc-biblioref">Hewett, Myer, and Ford 2006</a>)</span>. Hormonal changes across the menstrual cycle may influence ligament flexibility, neuromuscular coordination, and fatigue perception.</p>
<p>The model incorporates two key types of contextual information:</p>
<section id="a.-hormonal-context-self-reported-information" class="level3">
<h3 class="anchored" data-anchor-id="a.-hormonal-context-self-reported-information">a. Hormonal Context (Self-Reported Information)</h3>
<p>Since directly measuring hormone levels requires blood tests and is impractical for regular tracking, the model uses information athletes can report themselves:</p>
<ul>
<li>Menstrual cycle phase</li>
<li>Hormonal contraceptive use</li>
<li>Cycle regularity</li>
<li>Symptom severity (cramps, bloating, mood changes)</li>
<li>Perceived coordination or joint stability</li>
</ul>
<p>Research shows these measures can be linked to changes in injury risk patterns <span class="citation" data-cites="herzberg2017">(<a href="#ref-herzberg2017" role="doc-biblioref">Herzberg et al. 2017</a>)</span>.</p>
</section>
<section id="b.-stress-and-recovery-status" class="level3">
<h3 class="anchored" data-anchor-id="b.-stress-and-recovery-status">b. Stress and Recovery Status</h3>
<p>Short-term readiness indicators that fluctuate more rapidly:</p>
<ul>
<li>Sleep duration and quality</li>
<li>Daily stress ratings</li>
<li>Fatigue and muscle soreness</li>
<li>Mood or irritability</li>
<li>Time since last high-intensity session</li>
<li>Resting heart rate (when available)</li>
</ul>
<p>By combining stable physical metrics with dynamic contextual information, the model reflects both an athlete’s baseline risk profile and their current readiness state. This approach acknowledges that identical training activities may carry different risk levels depending on recovery, stress, and hormonal context.</p>
</section>
</section>
</section>
<section id="step-4-what-the-model-produces" class="level1">
<h1>Step 4: What the Model Produces</h1>
<p>The model classifies athletes into risk categories (high, medium, or low risk) rather than predicting whether an injury will definitely occur.</p>
<p>This makes the model more practical and useful as ACL injuries are highly context-dependent, often arising from unpredictable situations like change of direction, collisions, loss of balance, or landing in an awkward angle. Machine learning models can integrate multiple risk factors into probabilistic frameworks, but attempting to predict specific injury events would overstate what the model can do <span class="citation" data-cites="kumar2019mlinjury">(<a href="#ref-kumar2019mlinjury" role="doc-biblioref">Kumar, Singh, and Sharma 2019</a>)</span>. Instead, the model provides:</p>
<ul>
<li>Risk classification: High, medium, or low risk categories based on current physical status, recovery state, and hormonal context</li>
<li>Decision support: Information to guide preventative strategies, not diagnostic certainty</li>
<li>Adaptability: Risk categories that update based on changing inputs like training load, sleep, and menstrual cycle phase</li>
</ul>
</section>
<section id="practical-applications" class="level1">
<h1>Practical Applications</h1>
<p>These risk classifications help inform:</p>
<ul>
<li>Training adjustments: If an athlete is in a high-risk period, reduce high-intensity cutting drills, plyometrics (jump training), or full-contact scrimmages</li>
<li>Movement quality focus: During medium-risk periods, spend extra time on landing mechanics, balance exercises, and controlled cutting practice rather than high-speed game situations</li>
<li>Playing time decisions: Consider limiting play time or competitions during high-risk windows, or avoiding back-to-back intense matches</li>
<li>Recovery priority: When stress and fatigue are elevated, ensure at least one full rest day, prioritize sleep (7-9 hours), and avoid scheduling hard practices on consecutive days</li>
</ul>
<p>The model functions as a decision-support tool, not a diagnostic system. It accepts uncertainty while still offering actionable guidance.</p>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>ACL injuries are among the most serious challenges in women’s sports, often requiring surgery, disrupting athletic careers, and increasing the risk of reinjury. While the exact timing of an ACL injury cannot be predicted, periods of elevated risk can be identified.</p>
<p>This model shifts injury management from reactive treatment to proactive prevention by estimating an athlete’s current injury risk rather than predicting specific injury events. It integrates movement assessments, injury history, training load, recovery status, and female-specific factors such as menstrual cycle phase to classify risk as low, medium, or high.</p>
<p>These risk estimates support practical decision-making. During higher-risk periods, coaches can adjust training intensity, athletes can prioritize recovery and movement quality, and teams can make more informed choices about practice and playing time.</p>
<p>This fulfills the model’s goal: giving coaches and athletes the information they need to make smarter decisions about training, recovery, and participation. By flagging high-risk periods, the model enables proactive prevention—adjusting workloads and prioritizing movement quality before injury occurs. Used alongside clinical expertise and coaching judgment, this risk-based approach provides a practical path toward reducing ACL injury rates in women’s sports.</p>
</section>
<section id="references" class="level1">
<h1>References</h1>
<ol type="1">
<li>Tjong, V. (2024). “Why Women Have More ACL Injuries Than Men.” Northwestern Medicine. https://www.nm.org/healthbeat/healthy-tips/fitness/why-women-have-more-acl-injuries-than-men</li>
<li>Allen, C. (2025). “Why women athletes face higher ACL injury risk than men.” NPR.</li>
<li>Chia, L., et al.&nbsp;(2022). “Non-contact Anterior Cruciate Ligament Injury Epidemiology in Team-Ball Sports: A Systematic Review with Meta-analysis.” Sports Medicine, 52, 2763-2775.</li>
<li>Koga, H., et al.&nbsp;(2010). “Mechanisms for noncontact anterior cruciate ligament injuries: knee joint kinematics in 10 injury situations from female team handball and basketball.” American Journal of Sports Medicine, 38(11), 2218-2225.</li>
<li>Wright, R.W., et al.&nbsp;(2007). “Ipsilateral Graft and Contralateral ACL Rupture at Five Years or More Following ACL Reconstruction: A Systematic Review.” Journal of Bone and Joint Surgery, 93(12), 1159-1165.</li>
<li>Paterno, M.V., et al.&nbsp;(2012). “Incidence of Contralateral and Ipsilateral Anterior Cruciate Ligament (ACL) Injury After Primary ACL Reconstruction and Return to Sport.” Clinical Journal of Sport Medicine, 22(2), 116-121.</li>
<li>van Dijk, C.N., et al.&nbsp;(2020). “Injury mechanisms and prevention strategies in female athletes.” Sports Medicine, 50, 2041-2061.</li>
<li>Kumar, R., et al.&nbsp;(2019). “Machine learning approaches to injury risk prediction in sport.” Journal of Sports Analytics, 5(4), 277-294.</li>
<li>Hewett, T.E., Myer, G.D., &amp; Ford, K.R. (2006). “Anterior cruciate ligament injuries in female athletes: Part 1, mechanisms and risk factors.” The American Journal of Sports Medicine, 34(2), 299-311.</li>
<li>Herzberg, S.D., et al.&nbsp;(2017). “The Effect of Menstrual Cycle and Contraceptives on ACL Injuries and Laxity: A Systematic Review and Meta-analysis.” Orthopaedic Journal of Sports Medicine, 5(7).</li>
</ol>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-allen2025npr" class="csl-entry" role="listitem">
Allen, Chloe. 2025. <span>“Why Women Athletes Face Higher ACL Injury Risk Than Men.”</span> NPR.
</div>
<div id="ref-chia2022noncontact" class="csl-entry" role="listitem">
Chia, Luke, Danilo De Oliveira Silva, Matthew Whalan, Marnee J. McKay, Joanne Sullivan, Colin W. Fuller, and Evangelos Pappas. 2022. <span>“Non-Contact Anterior Cruciate Ligament Injury Epidemiology in Team-Ball Sports: A Systematic Review with Meta-Analysis.”</span> <em>Sports Medicine</em> 52: 2763–75. <a href="https://doi.org/10.1007/s40279-022-01697-w">https://doi.org/10.1007/s40279-022-01697-w</a>.
</div>
<div id="ref-vandijk2020injury" class="csl-entry" role="listitem">
Dijk, C. Niek van, Louis S. L. Lim, A. Poortman, J. Strüwer, and M. Maas. 2020. <span>“Injury Mechanisms and Prevention Strategies in Female Athletes.”</span> <em>Sports Medicine</em> 50: 2041–61. <a href="https://doi.org/10.1007/s40279-020-01320-3">https://doi.org/10.1007/s40279-020-01320-3</a>.
</div>
<div id="ref-herzberg2017" class="csl-entry" role="listitem">
Herzberg, Steven D., Makalapua L. Motu’apuaka, William Lambert, Rongwei Fu, Jennifer Brady, and Jeanne-Marie Guise. 2017. <span>“The Effect of Menstrual Cycle and Contraceptives on ACL Injuries and Laxity: A Systematic Review and Meta-Analysis.”</span> <em>Orthopaedic Journal of Sports Medicine</em> 5 (7). <a href="https://doi.org/10.1177/2325967117718781">https://doi.org/10.1177/2325967117718781</a>.
</div>
<div id="ref-hewett2007acl" class="csl-entry" role="listitem">
Hewett, Timothy E., Gregory D. Myer, and Kevin R. Ford. 2006. <span>“Anterior Cruciate Ligament Injuries in Female Athletes: Part 1, Mechanisms and Risk Factors.”</span> <em>The American Journal of Sports Medicine</em> 34 (2): 299–311. <a href="https://doi.org/10.1177/0363546505284183">https://doi.org/10.1177/0363546505284183</a>.
</div>
<div id="ref-koga2010acl" class="csl-entry" role="listitem">
Koga, Hideyuki, Atsuo Nakamae, Yohei Shima, Junsuke Iwasa, Grethe Myklebust, Lars Engebretsen, Roald Bahr, and Tron Krosshaug. 2010. <span>“Mechanisms for Noncontact Anterior Cruciate Ligament Injuries: Knee Joint Kinematics in 10 Injury Situations from Female Team Handball and Basketball.”</span> <em>American Journal of Sports Medicine</em> 38 (11): 2218–25. <a href="https://doi.org/10.1177/0363546510373570">https://doi.org/10.1177/0363546510373570</a>.
</div>
<div id="ref-kumar2019mlinjury" class="csl-entry" role="listitem">
Kumar, Ravi, Prashant Singh, and Ankit Sharma. 2019. <span>“Machine Learning Approaches to Injury Risk Prediction in Sport.”</span> <em>Journal of Sports Analytics</em> 5 (4): 277–94. <a href="https://doi.org/10.3233/JSA-190265">https://doi.org/10.3233/JSA-190265</a>.
</div>
<div id="ref-paterno2012incidence" class="csl-entry" role="listitem">
Paterno, Mark V., Mitchell J. Rauh, Laura C. Schmitt, Kevin R. Ford, and Timothy E. Hewett. 2012. <span>“Incidence of Contralateral and Ipsilateral Anterior Cruciate Ligament (ACL) Injury After Primary ACL Reconstruction and Return to Sport.”</span> <em>Clinical Journal of Sport Medicine</em> 22 (2): 116–21. <a href="https://doi.org/10.1097/JSM.0b013e318246ef9e">https://doi.org/10.1097/JSM.0b013e318246ef9e</a>.
</div>
<div id="ref-tjong2024gender" class="csl-entry" role="listitem">
Tjong, Vehniah. 2024. <span>“Why Women Have More ACL Injuries Than Men.”</span> Northwestern Medicine. <a href="https://www.nm.org/healthbeat/healthy-tips/fitness/why-women-have-more-acl-injuries-than-men">https://www.nm.org/healthbeat/healthy-tips/fitness/why-women-have-more-acl-injuries-than-men</a>.
</div>
<div id="ref-wright2007second" class="csl-entry" role="listitem">
Wright, Rick W., Warren R. Dunn, Annunziato Amendola, Jack T. Andrish, John Bergfeld, Christopher C. Kaeding, Robert G. Marx, et al. 2007. <span>“Ipsilateral Graft and Contralateral ACL Rupture at Five Years or More Following ACL Reconstruction: A Systematic Review.”</span> <em>Journal of Bone and Joint Surgery</em> 93 (12): 1159–65. <a href="https://doi.org/10.2106/JBJS.J.00898">https://doi.org/10.2106/JBJS.J.00898</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>